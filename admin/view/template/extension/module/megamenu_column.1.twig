{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="pull-right">
        <button type="submit" form="form-module" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button>
        <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a></div>
      <h1>{{ heading_title }}</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
        <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="container-fluid">
    {% if error_warning %}
    <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
      <button type="button" class="close" data-dismiss="alert">&times;</button>
    </div>
    {% endif %}
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-pencil"></i> {{ text_edit }}</h3>
      </div>
      <div class="panel-body">
        
          
          <form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-module" class="form-horizontal">
            <div class="form-group">
              <label class="col-sm-2 control-label" for="input-name">{{ entry_name }}</label>
              <div class="col-sm-10">
                <input type="text" name="name" value="{{ name }}" placeholder="{{ entry_name }}" id="input-name" class="form-control" />
                {% if error_name %}
                <div class="text-danger">{{ error_name }}</div>
                {% endif %}
              </div>
            </div>

            <div class="form-group">
              <label class="col-sm-2 control-label" for="input-link">{{ entry_link }}</label>
              <div class="col-sm-10">
                <input type="text" name="link" value="{{ link }}" placeholder="{{ entry_link }}" id="input-link" class="form-control" />
                {% if error_link %}
                <div class="text-danger">{{ error_link }}</div>
                {% endif %}
              </div>
            </div>

            <div class="form-group">
              <label class="col-sm-2 control-label" for="entry_icon">{{ entry_icon }}</label>
              <div class="table-responsive col-sm-10">
                <table class="table table-striped table-bordered table-hover">
                  <tbody>
                    <tr>
                      <td class="text-left"><a href="" id="icon-image" data-toggle="image" class="img-thumbnail"><img src="/image/{{ icon }}" alt="" title="" data-placeholder="{{ placeholder }}" /></a>
                        <input type="hidden" name="icon" value="{{ icon }}" id="input-icon" /></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <div class="form-group">
              <label class="col-sm-2 control-label" for="input-type">{{ entry_type }}</label>
              <div class="col-sm-10">
                <select name="type" id="input-type" class="form-control">
                  {% if type == "type_column" %}
                  <option value="type_column" selected="selected">{{ type_column }}</option>
                  <option value="type_image">{{ type_image }}</option>
                  <option value="type_slide">{{ type_slide }}</option>
                  {% elseif type == "type_image" %}
                  <option value="type_column">{{ type_column }}</option>
                  <option value="type_image" selected="selected">{{ type_image }}</option>
                  <option value="type_slide">{{ type_slide }}</option>
                  {% else %}
                  <option value="type_column">{{ type_column }}</option>
                  <option value="type_image">{{ type_image }}</option>
                  <option value="type_slide" selected="selected">{{ type_slide }}</option>
                  {% endif %}
                </select>
              </div>
            </div>
            
            <div class="form-group">
              <label class="col-sm-2 control-label" for="input-category"><span data-toggle="tooltip" title="{{ help_category }}">{{ entry_category }}</span></label>
              <div class="col-sm-10">
                <input type="text" name="category" value="" placeholder="{{ entry_category }}" id="input-category" class="form-control" />
                <div id="product-category" class="well well-sm" style="height: 150px; overflow: auto;"> 
                  {% for product_category in product_categories %}
                  <div id="product-category{{ product_category.value }}"><i class="fa fa-minus-circle"></i> {{ product_category.label }}
                    <input type="hidden" name="product_category[]" value="{{ product_category.value }}" />
                  </div>
                  {% endfor %}</div>
              </div>
            </div>

            <div class="form-group">
              <label class="col-sm-2 control-label" for="input-status">{{ entry_status }}</label>
              <div class="col-sm-10">
                <select name="status" id="input-status" class="form-control">
                  {% if status %}
                  <option value="1" selected="selected">{{ text_enabled }}</option>
                  <option value="0">{{ text_disabled }}</option>
                  {% else %}
                  <option value="1">{{ text_enabled }}</option>
                  <option value="0" selected="selected">{{ text_disabled }}</option>
                  {% endif %}
                </select>
              </div>
            </div>
            <div class="page-header">
              <div class="pull-right">
                <button type="button"  id="megamenu_item_add" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button>
              </div>
              <h1>{{ heading_title }}</h1>
              <ul class="breadcrumb">
                {% for breadcrumb in breadcrumbs %}
                <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
                {% endfor %}
              </ul>
              <div id="megamenu_item_list">
                {% for menuItem in menuItems %}
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <div class="pull-right" style="margin-top:-9px">
                      <button type="submit" form="form-module" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button>
                      <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a>
                    </div>
                    <h3 class="panel-title">Add new item</h3>
                  </div>
                  <div class="panel-body">
                      <div class="form-group">
                        <label class="col-sm-2 control-label" for="input_entry_column_item_name_{{ menuItem.name}}">{{ entry_column_item_name }}</label>
                        <div class="col-sm-10">
                          <input type="text" name="menuItems[{{ loop.index }}][item_name]" value="{{ menuItem.item_name }}" placeholder="{{ entry_column_item_name }}" id="input_entry_column_item_name_{{ menuItem.name}}" class="form-control" />
                          {% if menuItem.error_name %}
                          <div class="text-danger">{{ menuItem.error_name }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-entry_column_item_link">{{ entry_column_item_link }}</label>
                        <div class="col-sm-10">
                          <input type="text" name="menuItems[{{ loop.index }}][item_link]" value="{{ menuItem.item_link }}" placeholder="{{ entry_column_item_link }}" id="input-entry_column_item_link" class="form-control" />
                          {% if menuItem.error_link %}
                          <div class="text-danger">{{ menuItem.error_link }}</div>
                          {% endif %}
                        </div>
                      </div>
                      
                      <div class="form-group">
                        <label class="col-sm-2 control-label" for="entry_column_item_image">{{ entry_column_item_image }}</label>
                        <div class="table-responsive col-sm-10">
                          <table class="table table-striped table-bordered table-hover">
                            <tbody>
                              <tr>
                                <td class="text-left"><a href="" id="thumb-image" data-toggle="image" class="img-thumbnail"><img src="{{ menuItem.thumb }}" alt="" title="" data-placeholder="{{ placeholder }}" /></a>
                                  <input type="hidden" name="menuItems[{{ loop.index }}][item_image]" value="{{ menuItem.item_image }}" id="input-image" /></td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>

                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
            

            

          </form>
        
      </div>
    </div>
  </div>
</div>

<div class="panel panel-default megamenu_item_detail" id="megamenu_item_detail" style="display:none;">
  <div class="panel-heading">
    <div class="pull-right" style="margin-top:-9px">
      <button type="submit" form="form-module" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button>
      <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a>
    </div>
    <h3 class="panel-title">Add new item</h3>
  </div>
  <div class="panel-body">
      <div class="form-group">
        <label class="col-sm-2 control-label" for="input_entry_column_item_name">{{ entry_column_item_name }}</label>
        <div class="col-sm-10">
          <input type="text"  name="menuItems[][item_name]" placeholder="{{ entry_column_item_name }}" id="input_entry_column_item_name" class="form-control" />
          
        </div>
      </div>
      <div class="form-group">
        <label class="col-sm-2 control-label" for="input_entry_column_item_link">{{ entry_column_item_link }}</label>
        <div class="col-sm-10">
          <input type="text" name="menuItems[][item_link]"  placeholder="{{ entry_column_item_link }}" id="input_entry_column_item_link" class="form-control" />
          
        </div>
      </div>
      
      <div class="form-group">
        <label class="col-sm-2 control-label" for="entry_column_item_image">{{ entry_column_item_image }}</label>
        <div class="table-responsive col-sm-10">
          <table class="table table-striped table-bordered table-hover">
            <tbody>
              <tr>
                <td class="text-left"><a href="" id="thumb-image" data-toggle="image" class="img-thumbnail"><img src="{{ thumb }}" alt="" title="" data-placeholder="{{ placeholder }}" /></a>
                  <input type="hidden" name="menuItems[][item_image]" id="input-image" /></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="form-group">
        <label class="col-sm-2 control-label" for="input_entry_column_item_css">{{ entry_column_item_css }}</label>
        <div class="col-sm-10">
          <input type="text" name="menuItems[][item_css]"  placeholder="{{ entry_column_item_css }}" id="input_entry_column_item_css" class="form-control" />
        </div>
      </div>
      
      <div class="form-group">
        <label class="col-sm-2 control-label" for="input_entry_column_item_style">{{ entry_column_item_style }}</label>
        <div class="col-sm-10">
          <input type="text" name="menuItems[][item_style]"  placeholder="{{ entry_column_item_style }}" id="input_entry_column_item_style" class="form-control" />
        </div>
      </div>
     
      <div class="pull-right">
        <button type="button"  id="input_entry_column_item_add" title="{{ button_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button>
      </div>
  </div>
</div>

<script type="text/javascript"><!--
var detailNumber = {{ menuItems|length }} + 1;
$('#megamenu_item_add').on('click', function(){
  var clone = $('#megamenu_item_detail').clone();
  clone.attr('id', 'megamenu_item_detail_'+detailNumber);
  clone.css({'display': 'block'});

  var itemName = clone.find("#input_entry_column_item_name");
  itemName.attr('name', 'menuItems['+detailNumber+'][item_name]');
  itemName.attr('id', 'input_entry_column_item_name'+detailNumber);

  var itemLink = clone.find("#input_entry_column_item_link");
  itemLink.attr('name', 'menuItems['+detailNumber+'][item_link]');
  itemLink.attr('id', 'input_entry_column_item_link'+detailNumber);

  var itemImage = clone.find("#input-image");
  itemImage.attr('name', 'menuItems['+detailNumber+'][item_image]');
  itemImage.attr('id', 'input-image'+detailNumber);

  var itemCss = clone.find("#input_entry_column_item_css");
  itemCss.attr('name', 'menuItems['+detailNumber+'][item_css');
  itemCss.attr('id', 'input_entry_column_item_css'+detailNumber);

  var itemStyle = clone.find("#input_entry_column_item_style");
  itemStyle.attr('name', 'menuItems['+detailNumber+'][item_style]');
  itemStyle.attr('id', 'input_entry_column_item_style'+detailNumber);

  var itemAdd = clone.find("#input_entry_column_item_add");
  itemAdd.attr('id', 'input_entry_column_item_add'+detailNumber);

  $('#megamenu_item_list').prepend(clone);
  detailNumber++;
});

function buildItemName(){
  var id = 'item_name' + Math.random();
  var item = '<div class="form-group">' + 
        '<label class="col-sm-2 control-label" for="'+id+'">{{ entry_column_item_name }}</label>'+
        '<div class="col-sm-10">'+
          '<input type="text" name="item_name" placeholder="{{ entry_column_item_name }}" id="'+id+'" class="form-control item-name" />'+
        '</div>'+
      '</div>';

  return item;
}

function buildItemLink(){
  var id = 'item_link' + Math.random();
  var item = '<div class="form-group">' + 
        '<label class="col-sm-2 control-label" for="'+id+'">{{ entry_column_item_link }}</label>' + 
        '<div class="col-sm-10">' + 
          '<input type="text" name="item_link"  placeholder="{{ entry_column_item_link }}" id="'+id+'" class="form-control item-link" />' + 
        '</div>' + 
      '</div>';

  return item;
}

function buildItemImage(){
  var id = 'item_image' + Math.random();
  var item = '<div class="form-group">' +
        '<label class="col-sm-2 control-label" for="'+id+'">{{ entry_column_item_image }}</label>' +
        '<div class="table-responsive col-sm-10">' +
          '<table class="table table-striped table-bordered table-hover">' +
            '<tbody>' +
             '<tr>' +
                '<td class="text-left"><a href="" id="thumb-image" data-toggle="image" class="img-thumbnail"><img src="{{ thumb }}" alt="" title="" data-placeholder="{{ placeholder }}" /></a>' +
                  '<input type="hidden" name="item_image" id="input-image" class="item-image" /></td>' +
              '</tr>' +
            '</tbody>' +
          '</table>' +
        '</div>' +
      '</div>';
    
    return item;
}
function buildItemCss(){
  var id = 'item_css' + Math.random();
  var item = '<div class="form-group">' + 
        '<label class="col-sm-2 control-label" for="'+id+'">{{ entry_column_item_css }}</label>' + 
        '<div class="col-sm-10">' + 
          '<input type="text" name="item_css"  placeholder="{{ entry_column_item_css }}" id="'+id+'" class="form-control item-css" />' + 
        '</div>' + 
      '</div>';

  return item;
}

function buildItemStyle(){
  var id = 'item_style' + Math.random();
  var item = '<div class="form-group">' + 
        '<label class="col-sm-2 control-label" for="'+id+'">{{ entry_column_item_style }}</label>' + 
        '<div class="col-sm-10">' + 
          '<input type="text" name="item_style"  placeholder="{{ entry_column_item_style }}" id="'+id+'" class="form-control item-style" />' + 
        '</div>' + 
      '</div>';

  return item;
}

// Category
$('input[name=\'category\']').autocomplete({
	'source': function(request, response) {
    response({{ listModule }});
	},
	'select': function(item) {
		$('input[name=\'category\']').val('');

		$('#product-category' + item['value']).remove();

		$('#product-category').append('<div id="product-category' + item['value'] + '"><i class="fa fa-minus-circle"></i> ' + item['label'] + '<input type="hidden" name="product_category[]" value="' + item['value'] + '" /></div>');
	}
});

$('#product-category').delegate('.fa-minus-circle', 'click', function() {
	$(this).parent().remove();
});
//--></script> 

{{ footer }}